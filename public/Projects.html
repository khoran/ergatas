<div class="lift:surround?with=default-withmenu&at=content"> 

  <head>
    <link href="/css/bootstrap.min.css" rel="stylesheet" media="screen"> 
    <link href="/custom.css" rel="stylesheet" type="text/css">
    <link href="/css/bootstrap-responsive.css" rel="stylesheet"> 

    <!-- X-Editable -->
    <link href= "/bs3-xeditable/bootstrap3-editable/css/bootstrap-editable.css" rel="stylesheet" />
    <script src="/bs3-xeditable/bootstrap3-editable/js/bootstrap-editable.min.js" type="text/javascript"></script>

    <!-- X-Editable typeahead -->
    <link href= "/bs3-xeditable/inputs-ext/typeaheadjs/lib/typeahead.js-bootstrap.css" rel="stylesheet" />
    <script src="/bs3-xeditable/inputs-ext/typeaheadjs/lib/typeahead.js" type="text/javascript"></script>
    <script src="/bs3-xeditable/inputs-ext/typeaheadjs/typeaheadjs.js" type="text/javascript"></script>

    <!--  Selectize -->
    <script src="/webjars/selectize.js/0.12.3/js/standalone/selectize.min.js" type="text/javascript"></script> 
    <link href= "/webjars/selectize.js/0.12.3/css/selectize.css" rel="stylesheet" />

    <!-- AlertifyJS-->                                                                                                     
    <script type='text/javascript' src="/alertify/alertify.min.js"></script>                                                
    <link rel="stylesheet" href="/alertify/css//alertify.min.css" />                                                        
    <link rel="stylesheet" href="/alertify/css/themes/default.min.css" />      


    <!--  KnockoutJS -->
    <script src="/webjars/knockout/3.4.1/knockout.debug.js" type="text/javascript"></script> 
    <script src="/webjars/knockout-mapping/2.4.1/knockout.mapping.js" type="text/javascript"></script> 
    <script src="/js/knockout.x-editable.js" type="text/javascript"></script> 
    <script src="/js/knockout.reactor.js" type="text/javascript"></script> 
    <script src="/js/ko-common.js" type="text/javascript"></script> 
    <script src="/js/ko-components.js" type="text/javascript"></script> 

    <!-- DataTabels -->
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.16/css/jquery.dataTables.css">
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.js"></script>

    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAlLLhrgatWKGGy-tpNM6o9otGLhla9rBM"></script>

    <!-- VideoJS -->
    <link href="/videojs/video-js.min.css" rel="stylesheet">
    <script src="/videojs/video.min.js"></script>
    <script src="/videojs/RecordRTC.min.js"></script>
    <script src="/videojs/adapter.js"></script>


    <script src="/videojs/wavesurfer.js-2.2.1/dist/wavesurfer.min.js"></script>
    <script src="/videojs/wavesurfer.js-2.2.1/dist/plugin/wavesurfer.microphone.min.js"></script>
    <link href="/videojs/videojs-wavesurfer/dist/css/videojs.wavesurfer.min.css" rel="stylesheet">
    <script src="/videojs/videojs-wavesurfer/dist/videojs.wavesurfer.js"></script>

    <link href="/videojs/videojs-record/dist/css/videojs.record.min.css" rel="stylesheet">
    <script src="/videojs/videojs-record/dist/videojs.record.min.js"></script>

    <!-- local -->

    <script src="/js/alertify-dialogs.js?ver14" type="text/javascript"></script>
    <script src="projects.js" type="text/javascript"></script>
    <script src="/js/beanForms.js" type="text/javascript"></script>

  </head>
  <style>
    .wide-textarea{
      width: 60vw !important;
    }
  </style>

  <script type="text/html" id="">
  </script>
  <!-- not used -->
  <div style="display: none" data-bind="stopBinding: true" >
    <div id="new-project-template">
      <label> Language</label>
      <br>
      <input data-bind='languageInput:languageNumber,nameValue: languageName' placeholder='Language Name or Number'></input>
      <br>
      <br>
      <label>Location</label>
      <br>
      <input data-bind='locationInput: locationKey,nameValue: locationName'  placeholder='Location Name'></input>
      <br>
      <a data-bind="click: viewModel.showMap">Select on Map</a>
      <br>
      <div id="OFFlocationMap"></div>
    </div>

  </div>

  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <button class="btn" data-bind="click: save">Save</button>
        <button class="btn" data-bind="visible: haveSavedData(),click: load">Load</button>
        <button class="btn" data-bind="visible: haveSavedData(),click: clearStorage">Clear</button>
      </div>
    </div>


    <div class="row">
      <div class="col-md-10">
        <h2>Recording Projects</h2>
      </div>
      <div class="col-md-2">
        <span data-bind="visible: online()" class="label label-success">
          Online
        </span>
        <span data-bind="visible: ! online()" class="label label-danger">
          Offline
        </span>

      </div>
    </div>

    <div data-bind="if: displayMode() === 'list'">

      <div class="row">
        <div class="col-md-10">
          <h3>Current Projects</h3>
        </div>
        <div class="col-md-2">
          <button class="btn btn-primary" data-bind="click: createProject">
            New Project</button>
        </div>
      </div>

      <div data-bind="if: projectSummaries().length > 0">
        
        <div data-bind=" foreach: projectSummaries">
          <ul>
            <li>
              <a data-bind="click: $root.selectProject">
               <span data-bind="text: name"></span>
                <!--
               <span data-bind="text: languageName"></span>
               (<span data-bind="text: languageNumber"></span>),
               <span data-bind="text: locationName"></span>
               <span data-bind="text: status"></span> 
                -->
              </a>
            </li>
          </ul>

        </div>
      </div>

    </div> <!-- end 'list' display section -->



    <div data-bind="if: displayMode() === 'project'">
      <div data-bind="with: currentProject">
        <div class="row">
          <div class="col-md-10">
            <h2> <span data-bind="text: name"></span></h2>

            <br>
            <label>Language</label>
            <br>
            <input data-bind='languageInput:languageNumber,nameValue: languageName' placeholder='Language Name or Number'></input>
            <br>
            <a data-bind="attr: {href: 'LanguageInformation?languageNumber='+languageNumber()}">
              Current Language Information</a>
            <!--
            <label>Location</label>
            <br>
            <input data-bind='locationInput: locationKey,nameValue: locationName'  placeholder='Location Name'></input>
            <span data-bind="text: lattitude"></span>, <span data-bind="text:longitude"></span>
            <br>

            <a data-bind="click: function(){viewModel.showMap('locationMap',$data);}">Select on Map</a>
            <br>
            <div id="locationMap" style="height: 50vh" 
              data-bind="visible: $root.displayMap || (lattitude() != null && longitude() != null)"></div>
            -->
            <p>
            <div data-bind="visible: currentStep() === 1">
              <h4>Step 1:</h4> Create or upload a Language Information Form (LIF)
              <button class="btn" data-bind="click: $root.createLIF">Enter LIF</button>
              <button class="btn" data-bind="click: $root.uploadLIF">Upload LIF</button>
            </div>
            <div data-bind="visible: currentStep() === 2">
              <h4>Step 2:</h4> Create or upload a PRP
              <button class="btn" data-bind="click: $root.createPRP">Enter PRP</button>
              <button class="btn" data-bind="click: $root.uploadPRP">Upload PRP</button>
            </div>
            <div data-bind="visible: currentStep() === 3">
              <h4>Step 3:</h4> Create a trip
              <button class="btn" data-bind="click: $root.createTrip">Create Trip</button>
            </div>

            <p>
            <p>

            <hr>

          </div>
          <div class="col-md-2">
            <button class="btn" data-bind="click:function(){ $root.displayMode('list');}">
              Project List</button>
          </div>
        </div>

        <div data-bind="visible: lifs().length > 0">
          <div class="row">
            <div class="col-md-10">
              <h3 style="display: inline">LIFs</h3>
              <h4 style="display: inline; margin:1em">
                <a><i title="Create new LIF" class="glyphicon glyphicon-plus" data-bind="click: $root.createLIF"></i></a>
                <a><i title="Upload new LIF" class="glyphicon glyphicon-upload" data-bind="click: $root.uploadLIF"></i></a>
              </h4>
            </div>
            <div class="col-md-2">
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <ul>
                <div data-bind="foreach: lifs">
                  <li>
                    <a data-bind="click: $root.selectLIF">
                      <span data-bind="text: partName"></span>
                      (<span data-bind="text: partNumber"></span>)
                    </a>
                    <i class="glyphicon glyphicon-remove" 
                       data-bind="click: function(){$root.deleteLIF($data,$parent);}"></i>
                  </li>
                </div>
              </ul>
            </div>
          </div>
        </div>

        <div data-bind="visible: prps().length > 0">
          <div class="row">
            <div class="col-md-10">
              <h3 style="display: inline">PRPs</h3>
              <h4 style="display: inline; margin:1em">
                <a><i title="Create new PRP" class="glyphicon glyphicon-plus" data-bind="click: $root.createPRP"></i></a>
                <a><i title="Upload new PRP" class="glyphicon glyphicon-upload" data-bind="click: $root.uploadPRP"></i></a>
              </h4>

            </div>
            <div class="col-md-2">
            </div>
            <div class="col-md-12">
              <div data-bind="foreach: prps">
                <span data-bind="text: name"></span>
              </div>
            </div>
          </div>
        </div>


        <div data-bind="visible: trips().length > 0">
          <div class="row">
            <div class="col-md-10">
              <h3 style="display: inline;">Trips</h3>
              <h4 style="display: inline; margin:1em">
                <a><i title="Create new trip" class="glyphicon glyphicon-plus" data-bind="click: $root.createTrip"></i></a>
              </h4>
            </div>
            <div class="col-md-2">
            </div>
          </div>
          <div data-bind="if: trips().length > 0">
            <div data-bind="foreach: trips">
              <ul>
                <li>
                  <a data-bind="click: $root.selectTrip">
                    <span data-bind="text: name"></span>
                    &nbsp; &nbsp;
                    <span data-bind="text: startDate"></span> -
                    <span data-bind="text: endDate"></span>
                  </a>
                  <i class="glyphicon glyphicon-remove" 
                       data-bind="click: function(){$root.deleteTrip($data,$parent);}"></i>
                </li>
              </ul>
            </div>
          </div>
        </div>


          <div class="row">
            <div class="col-md-10">
              <h3 style="display: inline;">Feedback</h3>
              <h4 style="display: inline; margin:1em">
                <a><i title="Upload File" class="glyphicon glyphicon-upload" data-bind="click: $root.uploadFeedback"></i></a>
                <a><i title="Record Video" style="color: red" class="glyphicon glyphicon-record" data-bind="click: $root.recordVideo"></i></a>
              </h4>
            </div>
            <div class="col-md-2">
            </div>
          </div>
          <div data-bind="if: feedback().length > 0">
            <div data-bind="foreach: feedback">
              <ul>
                <li>
                  <span data-bind="text: filename"></span>
                  <i class="glyphicon glyphicon-remove" 
                       data-bind="click: function(){$root.deleteFeedback($data,$parent);}"></i>
                </li>
              </ul>
            </div>
          </div>




      <!--  <div>
          <h3>Feedback</h3>
          <video  id="myVideo" playsinline class="video-js vjs-default-skin"></video>
        </div>
      -->

      </div> <!-- end with currentProject -->
    </div> <!-- end 'project' display -->
    <div data-bind="if: displayMode() === 'lif'">
      <div data-bind="with: currentLIF">

        <div class="row">
          <div class="col-md-10">
            <h3>LIF Entry</h3>
            <lif-form params="languageNumber: $root.languageNumber,
                          lifPartNumber: partNumber,
                          lifPartName: partName "></lif-form>
            <button class="btn btn-primary" data-bind="click:function(){ $root.displayMode('project');}">
              Done</button>
          </div>
          <div class="col-md-2">
            <button class="btn" data-bind="click:function(){ $root.displayMode('project');}">
              Back</button>
          </div>
        </div>
      </div>
    </div><!-- end 'lif' display -->

    <div data-bind="if: displayMode() === 'trip'">
      <div data-bind="with: currentTrip">
          <div class="row">
            <div class="col-md-4">
              <h3 data-bind="editable: name" data-mode="inline"></h3>
            </div>
            <div class="col-md-2 col-md-offset-6">
              <button class="btn" data-bind="click:function(){ $root.displayMode('project');}">
                Back</button>
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">

              <div class="progress">
                <div class="progress-bar progress-bar-info" style="width:40%">
                  40% Complete (success)
                </div>
              </div>


            </div>
          </div>
          <div class="row">
            <div class="col-md-10">
              Status: <span data-bind="editable: status"></span> <br>
              Dates: 
              <span data-bind="editable: startDate" data-type="date" 
                data-mode="popover" data-placement="bottom"></span> - 
              <span data-bind="editable: endDate" data-type="date" 
                data-mode="popover" data-placement="bottom"></span> 
              <p>

              <b>Location:</b>
              <br>
              <input data-bind='locationInput: locationKey,nameValue: locationName'  placeholder='Location Name'></input>
              <br>
              <a data-bind="click: function(){viewModel.showMap('tripMap',$data);}">Or select on map</a>

              <div id="tripMap" style="height: 50vh" 
                data-bind="visible: $root.displayMap || (lattitude() != null && longitude() != null)"></div>

              <p>
              <div data-bind="dbField: {field:'cost',label:'Cost'}"></div>
              <div data-bind="dbField: {textarea:'costDescription',
                label: 'Cost Description',
                inline: false,
                editableOptions: {inputclass: 'wide-textarea'} }">
              </div>
              <p>
              <div data-bind="dbField: {field:'extraCost',label:'Extra Cost'}"></div>
              (What more could be done if extra funds were available)
              <div data-bind="dbField: {textarea:'extraCostDescription',
                label: 'Extra Cost Description',
                inline: false,
                editableOptions: {inputclass: 'wide-textarea'} }">
              </div>

              <p>
              <div data-bind="dbField: {textarea: 'description',
                label: 'Description',
                inline: false,
                editableOptions: {inputclass: 'wide-textarea'} }">
              </div>
            </div>
          </div>
      </div>
    </div><!-- end 'trip' display -->



  </div>


</div>
