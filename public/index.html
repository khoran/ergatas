<?DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Ergatas</title>

    <!--  
     <script type='text/javascript' src="http://localhost:9000/ergatas.js"></script>     
    -->                                     
    <script type='text/javascript' src="dist/ergatas.js"></script>                                                
    <script src="/js/postgrest-client.js" type="text/javascript"></script> 
    <script src="/js/knockout.mapping-2.4.1.js" type="text/javascript"></script> 
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?libraries=places&key=AIzaSyDOgV_i94uqhAIjyQmtkzerk2CZCrTa-Ec"></script>


    <!-- AlertifyJS-->                                                                                                     
    <script type='text/javascript' src="/alertify/alertify.min.js"></script>                                                
    <link rel="stylesheet" href="/alertify/css//alertify.min.css" />                                                        
    <link rel="stylesheet" href="/alertify/css/themes/default.min.css" />      

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-170138468-1"></script>
    <script>

      var app;
      jQuery(document).ready(function() {app= new ergatas.default.Client(); });


      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-170138468-1');
    </script>

  </head>

<body>
<script type="text/template" id="qq-template">
  <div class="qq-uploader-selector qq-uploader" qq-drop-area-text="Drop files here">
      <div class="qq-total-progress-bar-container-selector qq-total-progress-bar-container">
          <div role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" class="qq-total-progress-bar-selector qq-progress-bar qq-total-progress-bar"></div>
      </div>
      <div class="qq-upload-drop-area-selector qq-upload-drop-area" qq-hide-dropzone>
          <span class="qq-upload-drop-area-text-selector"></span>
      </div>
      <div class="qq-upload-button-selector qq-upload-button">
          <div>Upload a file</div>
      </div>
      <span class="qq-drop-processing-selector qq-drop-processing">
          <span>Processing dropped files...</span>
          <span class="qq-drop-processing-spinner-selector qq-drop-processing-spinner"></span>
      </span>
      <ul class="qq-upload-list-selector qq-upload-list" aria-live="polite" aria-relevant="additions removals">
          <li>
              <div class="qq-progress-bar-container-selector">
                  <div role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" class="qq-progress-bar-selector qq-progress-bar"></div>
              </div>
              <span class="qq-upload-spinner-selector qq-upload-spinner"></span>
              <img class="qq-thumbnail-selector" qq-max-size="100" qq-server-scale>
              <span class="qq-upload-file-selector qq-upload-file"></span>
              <span class="qq-edit-filename-icon-selector qq-edit-filename-icon" aria-label="Edit filename"></span>
              <input class="qq-edit-filename-selector qq-edit-filename" tabindex="0" type="text">
              <span class="qq-upload-size-selector qq-upload-size"></span>
              <button type="button" class="qq-btn qq-upload-cancel-selector qq-upload-cancel">Cancel</button>
              <button type="button" class="qq-btn qq-upload-retry-selector qq-upload-retry">Retry</button>
              <button type="button" class="qq-btn qq-upload-delete-selector qq-upload-delete">Delete</button>
              <span role="status" class="qq-upload-status-text-selector qq-upload-status-text"></span>
          </li>
      </ul>

      <dialog class="qq-alert-dialog-selector">
          <div class="qq-dialog-message-selector"></div>
          <div class="qq-dialog-buttons">
              <button type="button" class="qq-cancel-button-selector">Close</button>
          </div>
      </dialog>

      <dialog class="qq-confirm-dialog-selector">
          <div class="qq-dialog-message-selector"></div>
          <div class="qq-dialog-buttons">
              <button type="button" class="qq-cancel-button-selector">No</button>
              <button type="button" class="qq-ok-button-selector">Yes</button>
          </div>
      </dialog>

      <dialog class="qq-prompt-dialog-selector">
          <div class="qq-dialog-message-selector"></div>
          <input type="text">
          <div class="qq-dialog-buttons">
              <button type="button" class="qq-cancel-button-selector">Cancel</button>
              <button type="button" class="qq-ok-button-selector">Ok</button>
          </div>
      </dialog>
  </div>
</script>

<script type="text/html" id="org-application-page-template">
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <h3>Organization Application</h3>
        <p>
        Before an organization can be selected by a missionary, it must be approved to ensure
        it meets our requirements. 
        <p>
        Please select your organization from the list of non-profits below. Enter the primary website, 
        along with any websites donations may be collected on (if different than the primary website). 
        Also describe the main objective of the organization.

        <p>
        Once you submit the application, we will review it and get back to you within a few days. 
      </div>
    </div>
    <div class="row">
      <form class="col-md-12" data-bind="submit: $root.submitOrgApplication, using: organizationApplication()">
        
        <div class="form-group ">
          <select  placeholder="Organization Name" class="form-control"  data-bind="selectize: name,
            selectizeOptions: $root.nonProfitSelectizeOptions">
          </select> 
        </div>
        <div class="my-3" data-bind="visible: name">
          <span data-bind="text: city"></span>, <span data-bind="text: state"></span>.  <b>EIN</b> <span data-bind="text: ein"></span>  </br>
        </div>

        <div class='form-group'>
          <label for="website">Website</label>
          <input class='form-control' required id="website" name="website" data-bind="value: website  "/>
        </div>
        <div class='form-group'>
          <label for="org_description">Description</label>
          <textarea class='form-control' required id="org_description" name="org_description" data-bind="value: description">
          </textarea>
        </div>

        <button type="submit" class="btn btn-primary">Submit</button>

      </form>
    </div>
  </div>

</script>


  <script type="text/html" id="home-page-template">
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <h3 >  Ergatas <i style="font-size: 0.5em" class="oi oi-audio" data-bind="click: playSample"></i> </h3>
          <audio id="ergatas-sample" src="ergatas-sample.mp3" ></audio>
          <h4 class="my-2"> "... The harvest is plentiful but the workers are few.</br>
             Ask the Lord of the harvest, therefore, to send out
            workers (ergatas) into his harvest field." </br>
            <span class="ml-5">Mathew 9:37b-38</span>
          </h4>
          Ergatas aims to help those who want to be part of the great commission, through finanical support, to find 
          missionaries they can partner with. 
        </div>
      </div>
      <!--
      <div class="row">
        <div class="col-lg-6">
          <a class="btn btn-primary" data-bind="click: navigateFn('search')" >Find a Missionary</a>
        </div>
        <div class="col-lg-6">
          <button class="btn btn-primary" data-bind="click: navigateFn('profile')">Create a Missionary Profile</button>
        </div>
      </div>
      -->

      <div class="row">
        <div class="col-lg-12">


          

          <div style="margin-top:5em"></div>
          <div class="input-group">
            <input class="form-control" placeholder="Search by skill, location, or other keywords"
              data-bind="value:query, event:{keyup:handleSearch}">
            <span class="input-group-btn">
              <button class="btn btn-primary" data-bind="click: handleSearch">Find a Missionary</button>
            </span>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-lg-12">
          Are you a missionary? <a href="#" data-bind="click: navigateFn('profile')">Create a profile</a> to get started!
        </div>
      </div>

      <div class="row">
        <div class="col-lg-12 ">
          <h3 class="my-3 mt-5"> Featured Profiles </h3>
        </div>
      </div>
      <div class="row" data-bind="template: {data: $root.featuredProfiles, name:'list-results-template'}"> </div>


    </div>
  </script>
  <script type="text/html" id="search-page-template">
    <div class="container-fluid">
      <div class="row">
        <div class="col-lg-8">
          <div class="form-inline">
            <div class="input-group mx-2">
              <input  class="form-control" placeholder="Name" data-bind="textInput: $root.filter.name"/>
              <span class="input-group-append">
                <button class="btn" data-bind="click: function(){$root.filter.name(undefined);}""><i class="oi oi-circle-x"></i></button>
              </span>
             </div>
            <div class="input-group mx-2">
              <input class="form-control"placeholder="Organization" data-bind="textInput: $root.filter.organization"/>
              <span class="input-group-append">
                <button class="btn" data-bind="click: function(){$root.filter.organization(undefined);}""><i class="oi oi-circle-x"></i></button>
              </span>
            </div>

            <div xxclass="input-group mx-2">
              <select  placeholder="Skills" class="form-control" xxstyle="width:10em;"  data-bind="selectize:$root.filter.skills,
                selectizeOptions: $root.jobSelectizeOptions,selectizeMode: 'fixedOptions'">
              </select> 
            </div>

          </div>
        </div>


        <div class="col-lg-3 XXoffset-md-8">
          <select id="sort-by" class="form-control" data-bind="value: sortBy, click: sortResults">
            <option selected value="">Sort By ...</option>
            <option value="current_support_percentage,asc">Support Level (low to high)</option>
            <option value="current_support_percentage,desc">Support Level (high to low)</option>
            <option value="created_on,desc">Newest</option>
            <option value="created_on,asc">Oldest</option>
            <option value="organization_name">Organization</option>
          </select>
        </div>
        <div class="col-lg-1 " style="font-size: 1.7em">
          <i data-bind="click: searchListView" class="oi oi-list"></i>
          <i data-bind="click: searchMapView" class="oi oi-map"></i>
        </div>
      </div>
      <div class="row">
        <div class="col-lg-12">
          <div class="container-fluid">
            <div class="row" data-bind="template: {data:profiles, name:searchResultsTemplate, afterRender:initResultsView }"> </div>
          </div>
        </div>
      </div>
    </div>
  </script>
  <script type="text/html" id="edit-profile-page-template">
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <h3>Missionary Profile</h3>
        </div>
      </div>
      <div class="row">
        <div class="col-lg-6">
          <div data-bind="template:{data: $root.userProfile().data,name:'profile-form-template',afterRender:$root.initProfileForm}"></div>
        </div>
      </div>
    </div>
  </script>
  <script type="text/html" id="about-page-template">
    <h3>About Us</h3>
  </script>
  <script type="text/html" id="notfound-template">
    <h3>Sorry, that page was not found!</h3>
  </script>

  <script type="text/html" id="organization-template">

  </script>
  <script type="text/html" id="profile-card-template">
    <div class="card bg-light my-2" style="width:18rem;">
      <a href="#" data-bind="click: $root.selectProfile">
        <img  class="card-img-top" data-bind="visible: data.picture_url, attr:{src: data.picture_url || &apos;img/unknown_person.svg&apos; }">
      </a>
      <div class="card-body">
        <h3 class="card-title"><a href="#" data-bind="click: $root.selectProfile">
          <span data-bind="text: data.first_name"></span> <span data-bind="text: data.last_name"></span>
        </a> </h3>
        <div class="cart-subtitle" data-bind="using: $root.getOrganization($data.data.organization_key)">
          <a target="organization" data-bind="attr:{href:website}"><span data-bind="text: name"></span></a> 
        </div>

        <p class="card-text">
          <span data-bind="foreach: $root.jobCatagoryArray($data.data.job_catagory_keys)">
            <span class="badge badge-primary" data-bind="text: $data"></span> 
          </span>
        </p>
        <p class="card-text">
          <span data-bind="text: data.location"></span> 
        </p>
        <p class="card-text">
          Support Level: 
          <div class="progress">
            <div class="progress-bar" role="progressbar" data-bind="attr:{style: 'width: '+data.current_support_percentage+'%;'},text:data.current_support_percentage+'%'"></div>
          </div>
        </p>
        <a class="btn btn-primary" target="organization" data-bind="attr:{href:data.donation_url}">Donate</a>
        <a class="btn btn-primary" target="organization" href="#" data-bind="click: $root.selectProfile">Details</a>
      </div>
    </div>

  </script>
  <script type="text/html" id="list-results-template">
  
    <div class="row" data-bind="foreach: $data"> 
      <div class="col" data-bind="template: {data:$data, name:'profile-card-template'}"> </div>
    </div>

  </script>
  <script type="text/html" id="map-results-template">
    <div class="col-md-4" style="width:19em;height:90vh;overflow-y:scroll;overflow-x:hidden">
      <div class="container-fluid">
        <div data-bind="template:{data:$data,name:'list-results-template'}"></div>
      </div>

<!--       <div data-bind="template: {foreach:$data, name:'profile-card-template'}"> </div>

 -->    </div>
    <div class="col-md-8">
      <div id="search-results-map" style="height:90vh"></div>
    </div>
  </script>
  <script type="text/html" id="profile-detail-page-template">
    <div class="container" data-bind="with: selectedProfile().data">
      <div class="row">
        <div class="col-md-6">
          <h3 >
            <span data-bind="text: first_name"></span> <span data-bind="text: last_name"></span>
          </h3>


          <h5>Serving With</h5>
          <div class="" data-bind="using: $root.getOrganization($data.organization_key)">
            <a target="organization" data-bind="attr:{href:website}"><span data-bind="text: name"></span></a> 
            <br/>
            <span data-bind="text: city"></span>, <span data-bind="text: state"></span>
            <br/>
            <p data-bind="text: description"></p>
          </div>

        </div>
        <div class="col-md-6">
            <img width="100%"   data-bind="visible: picture_url, attr:{src: picture_url || &apos;img/unknown_person.svg&apos; }">
        </div>
      </div>
      <div class="row">
        <div class="col-md-12">


          <h5>Description</h5>
          <p data-bind="text: description"></p>

          <h5>Job Skills</h5>
          <p >
            <span data-bind="foreach: $root.jobCatagoryArray($data.job_catagory_keys)">
              <span class="badge badge-primary" data-bind="text: $data"></span> 
            </span>
          </p>
          <h5>Serving At</h5>
          <p >
            <span data-bind="text: location"></span> 
          </p>
          <h5> Support Level</h5>
          <p >
            <div class="progress">
              <div class="progress-bar" role="progressbar" data-bind="attr:{style: 'width: '+current_support_percentage+'%;'},text:current_support_percentage+'%'"></div>
            </div>
          </p>
          <a class="btn btn-primary" target="organization" data-bind="attr:{href:donation_url}">Donate</a>

        </div>
      </div>
    </div>
  </script>
  <script type="text/html" id="profile-form-template">
    <form data-bind="submit:$root.saveProfile">
      <div class='form-group'>
        <label for="organization">Organization</label>
        <select  placeholder="Non-profits"  data-bind="selectize:organization_key, selectizeOptions: $root.orgSelectizeOptions"> </select> 
        <a href="#" data-bind="click: $root.navigateFn('org-application')" style="font-size:0.7em;">Don't see your organization?</a>
      </div>

      <div class='form-group'>
        <label for="first_name">First Name</label>
        <input class='form-control' required id="first_name" name="first_name" data-bind="value:  first_name"/>
      </div>
      <div class='form-group'>
        <label for="last_name">Last Name</label>
        <input class='form-control' required id="last_name" name="last_name" data-bind="value:  last_name"/>
      </div>

            <!--
      <div class='form-group'>
        <label for="org_main_url">Organization Website</label>
        <input class="form-control" required placeholder="Organization Website" id="org_main_url" name="org_main_url" data-bind="value: $data && org_main_url" /> <br>
      </div>

      <div class='form-group'>
        <label for="org_description">Organization Description</label>
        <input class="form-control" placeholder="A few sentances describing what your organization does" id="org_description" name="org_description" data-bind="value: $data && org_description" /> <br>

      </div>
    -->

      <div class=''>
        <label for="jobs">Jobs</label>
        <select id="jobs" placeholder="Jobs" name="profile_jobs_view" data-bind="selectize:job_catagory_keys,
            selectizeOptions: $root.jobSelectizeOptions,selectizeMode: 'fixedOptions'">
           </select> <br>
      </div>

      <div class='form-group'>
        <label for="location">Location</label>
        <div id="locationMap" style="height: 50vh" ></div>

        <!-- <input class="form-control" placeholder="Location" id="location" name="location" data-bind="textInput: $data.location && location" /> <br>
 -->   
         <select id="location" placeholder="City, Country" name="location" data-bind="selectize:location,
            selectizeOptions: $root.locationSelectizeOptions"> </select> <br>

          <!-- need these here so they show up in the form output-->
          <input type="hidden" id="location_lat" name="location_lat" data-bind="value:  location_lat"/>
          <input type="hidden" id="location_long" name="location_long" data-bind="value:  location_long"/>
          <input type="hidden" id="country" name="country" data-bind="value:  country"/>

       <!--  <span data-bind="text: $data && location_lat"></span>, <span data-bind="text:$data && location_long"></span>
 -->      </div>
      <div class='form-group'>
        <label for="donation_url">Donation URL</label>
        <input class="form-control" required id="donation_url" placeholder="URL" name="donation_url" data-bind="value: donation_url" /> <br>
      </div>
      <div class='form-group'>
        <label for="support">Current Support Percentage: <span data-bind="text:current_support_percentage"></span>%</label>
        <input class="form-control" type="range" min="0" max="100" required placeholder="Support Percentage" id="support" 
          name="current_support_percentage" data-bind="value: current_support_percentage" /> <br>
      </div>
      <div class='form-group'>
        <label for="description">Description</label>
        <textarea class="form-control" placeholder="Description" id="description" name="description" data-bind="value: description"></textarea><br>
      </div>


      <div class='form-group'>
        <label for="description">Picture</label><br>
        <img width="200" data-bind="attr:{src: (picture_url()) || 'img/unknown_person.svg'}"/>
        <div id="fine-uploader" > </div>
        <input type="file" id="profile-picture"/>
      </div>
      <button class="btn btn-primary">Save</button>
    </form>
  </script>

 
  <nav class="navbar navbar-light bg-light navbar-expand-md">
    <!-- Brand and toggle get grouped for better mobile display -->
    <button type="button" class="navbar-toggler collapsed" data-toggle="collapse"
    data-target="#ergatas-navbar" aria-expanded="false"> <span class="sr-only">Toggle navigation</span>
&#x2630;</button> <a class="navbar-brand"
    data-bind="click: navigateFn(&apos;&apos;)">Ergatas</a>
    <div class="collapse navbar-collapse"
    id="ergatas-navbar">
        <ul class="nav navbar-nav">
            <li class="nav-item"><a data-bind="click: navigateFn(&apos;search&apos;)" class="nav-link">Search</a>
            </li>
            <li class="nav-item"><a data-bind="click: navigateFn(&apos;about&apos;)" class="nav-link">About</a>
            </li>
        </ul>
        <div class="form-inline ">
            <div class="input-group">
              <input type="text" class="form-control" placeholder="Search" data-bind="value:query, event:{keyup:handleSearch}">
              <button class="btn btn-outline-primary" type="button" data-bind="click: handleSearch"><i class="oi oi-magnifying-glass"></i></button>
            </div>
        </div>
        <ul class="nav navbar-nav ml-auto">
            <li data-bind="visible: ! $root.loggedIn() " class="nav-item"><a data-bind="click: navigateFn(&apos;signIn&apos;)" class="nav-link">Sign In / Sign Up</a>
            </li>
            <li data-bind="visible: $root.loggedIn " class="nav-item"><a data-bind="click: $root.signOut" class="nav-link">Sign Out</a>
            </li>
            <li class="nav-item"><a data-bind="visible: $root.loggedIn() &amp;&amp; ! $root.hasProfile(),

                            click: navigateFn(&apos;profile&apos;)" class="nav-link">Create Profile</a>
            </li>
            <li class="nav-item"><a data-bind="visible: $root.loggedIn() &amp;&amp; $root.hasProfile(), 

                            click: navigateFn(&apos;profile&apos;)" class="nav-link">Edit Profile</a>
            </li>
            <li data-bind="visible: $root.loggedIn " class="nav-item">
                <p class="navbar-text"><span data-bind="text: loggedInUser() &amp;&amp; loggedInUser().email"></span>
                </p>
            </li>
        </ul>
    </div>
</nav>


          <div data-bind="template: currentPage "></div>

          <!--
	<div class="container-fluid">
			<div class="row">
        <div class="col-lg-12">
        </div>
      </div>
    </div>
	</div>-->


</body>
</html>
