<div class="country-selector">
    
    <div data-bind="if: countryTree()" >
        <ul data-bind="let: {component: $data}">
            <li >
                <i class="ml-5" data-bind="click: countryTree().toggleSelectionFn(),class: countryTree().stateClass() "></i>
                <span  class="node-name" data-bind="click:countryTree().toggleSelectionFn()">Global</span>
                <ul data-bind="foreach: countryTree().children "> <!-- regions -->
                    <li>
                        <span class="caret" data-bind="click: component.flip($data.expanded)">
                            <i class="fa fa-2x" data-bind="css:{'fa-caret-right': ! $data.expanded(), 
                                                                'fa-caret-down':    $data.expanded()}"></i>
                        </span>

                        <i data-bind="click: $data.toggleSelectionFn(),class: $data.stateClass() "></i>
                        <span class="node-name" data-bind="text: $data.name, click: $data.toggleSelectionFn()"></span>
                        <ul data-bind="visible: $data.expanded,foreach: $data.children"> <!-- sub regions -->
                            <li>

                                <span class="caret" data-bind="click: component.flip($data.expanded)">
                                    <i class="fa fa-2x" data-bind="css:{'fa-caret-right': ! $data.expanded(), 
                                                                        'fa-caret-down':    $data.expanded()}"></i>
                                </span>
                                <i data-bind="click: $data.toggleSelectionFn(),class: $data.stateClass() "></i>
                                <span class="node-name" data-bind="text: $data.name, click: $data.toggleSelectionFn()"></span>
                                <ul data-bind="visible: $data.expanded,foreach: $data.children"> <!-- countries -->
                                    <li>
                                        <i class="ml-5" data-bind="click: $data.toggleSelectionFn(),class: $data.stateClass() "></i>
                                        <span class="node-name" data-bind="click: $data.toggleSelectionFn()">
                                            <img data-bind="attr:{src: $data.flagUrl}" width=20>
                                            <span data-bind="text: $data.name "></span>
                                        </span>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    
                </ul>
            </li>
            
        </ul>
    </div>
</div>