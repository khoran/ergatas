<div class="country-selector">
    
    <div data-bind="if: ! countryTree()" class="text-center">
        <img width=50 src="/img/block-spinner2.svg"/>
    </div>
    <div data-bind="if: countryTree()" >
        <ul data-bind="let: {component: $data}">
            <div data-bind="visible: component.ro &&  countryTree().nothingSelected()" style="display:none">
                No areas selected
            </div>
            <li data-bind="visible: !(component.ro &&  countryTree().nothingSelected())">
                <i class="ml-5" data-bind="click: countryTree().toggleSelectionFn(component.ro),class: countryTree().stateClass(component.ro) "></i>
                <span  class="node-name" data-bind="click:countryTree().toggleSelectionFn(component.ro)">Global</span>
                <ul data-bind="foreach: countryTree().children "> <!-- regions -->
                    <li data-bind="visible: !(component.ro &&  $data.nothingSelected())">
                        <span class="caret" data-bind="click: component.flip($data.expanded)">
                            <i class="fa fa-2x" data-bind="css:{'fa-caret-right': ! $data.expanded(), 
                                                                'fa-caret-down':    $data.expanded()}"></i>
                        </span>

                        <i data-bind="click: $data.toggleSelectionFn(component.ro),class: $data.stateClass(component.ro) "></i>
                        <span class="node-name" data-bind="text: $data.name, click: $data.toggleSelectionFn(component.ro)"></span>
                        <ul data-bind="visible: $data.expanded,foreach: $data.children"> <!-- sub regions -->
                            <li data-bind="visible: !(component.ro &&  $data.nothingSelected())">

                                <span class="caret" data-bind="click: component.flip($data.expanded)">
                                    <i class="fa fa-2x" data-bind="css:{'fa-caret-right': ! $data.expanded(), 
                                                                        'fa-caret-down':    $data.expanded()}"></i>
                                </span>
                                <i data-bind="click: $data.toggleSelectionFn(component.ro),class: $data.stateClass(component.ro) "></i>
                                <span class="node-name" data-bind="text: $data.name, click: $data.toggleSelectionFn(component.ro)"></span>
                                <ul data-bind="visible: $data.expanded,foreach: $data.children"> <!-- countries -->
                                    <li data-bind="visible: !(component.ro &&  $data.nothingSelected())">
                                        <i class="ml-5" data-bind="click: $data.toggleSelectionFn(component.ro),class: $data.stateClass(component.ro) "></i>
                                        <span class="node-name" data-bind="click: $data.toggleSelectionFn(component.ro)">
                                            <img data-bind="attr:{src: $data.flagUrl}" width=20>
                                            <span data-bind="text: $data.name "></span>
                                        </span>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    
                </ul>
            </li>
            
        </ul>
    </div>
</div>