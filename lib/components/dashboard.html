<div class="row my-5">
    <div class="col">
        <h2>Stats</h2>
        <div data-bind="with: stats">
            Donation Clicks: <span data-bind="text: donationClicks"></span>
            Page Views: <span data-bind="text: pageViews"></span>
            Prayers: <span data-bind="text: prayers"></span>
        </div>
    </div>
</div>

<div class="row my-5">
    <div class="col">
        <h2>Donations</h2>
        <table class="table table-striped">
            <tbody data-bind="foreach: donations">
                <tr>
                    <td data-bind="text: amount "></td>
                    <td data-bind="text: donation_type "></td>
                    <td data-bind="text: created_on"></td>
                    <td data-bind="text: confirmed"></td>
                    <td data-bind="text: paid"></td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<div class="row my-5" data-bind="if: org!=null" >
    <div class="col">
        <h2 class="d-inline-block" data-bind="text: org() && org().display_name"></h2>
        <div data-bind="visible: !editOrgMode(),with: org">
            <button class="btn btn-ergatas-primary float-right" data-bind="click:$component.editOrg">Edit</button>
            <img data-bind="attr:{src:$component.storage.orgLogoUrl(logo_url)}"/>
            <br/>
            <p data-bind="text: contact_email"></p>
            Sharing link: <a href="#" data-bind="attr:{href:'https://'+$root.domain+'/'+slug}" >
                https://<span data-bind="text: $root.domain"></span>/<span data-bind="text: slug"></span></a>
            <p data-bind="text: description"></p>
        </div>
        <form class="shaded-bg" data-bind="visible: editOrgMode(),submit: saveOrg,with:orgUpdates">

            <button class="btn btn-ergatas-primary float-right" type="submit">Save</button> 
            <div class='form-group '>
                <div data-bind="visible: logo_url" style="display:none" class="mb-1">
                    <img height="60" alt="organization logo" data-bind="attr:{src: $component.storage.orgLogoUrl(logo_url())}"/>
                    <br>
                </div>
                <button type="button" class="btn btn-ergatas-secondary-border" data-bind="click: () => $component.storage.browseForLogo($data)">Upload Logo</button>
            </div>
            <div class='form-group contains-validation-message'>
                <label for="email" class="required">Contact Email </label>
                <div class="muted-font">
                </div>
                <input class='form-control' type="email" required id="email" name="email" data-bind="value: contact_email,validation  "/>
            </div>
             <div class='form-group contains-validation-message'>
                <label for="slug" class="required">URL Slug</label>
                <div class="muted-font">
                    This is the text used in your link. E.g., ergatas.org/your-slug-here.
                </div>
                <input class='form-control' type="text" required id="slug" name="slug" data-bind="value:slug,validation  "/>
            </div>
             

            <div class='form-group contains-validation-message'>
                <label for="org_description" class="required">Description </label>
                <div class="muted-font" id="desc-help">
                    Briefly describe the main objective of your organization .
                </div>
                <textarea class='form-control' required id="org_description" name="org_description" data-bind="value: description,validation">
                </textarea>
            </div>
        </form>
    </div>
</div>
<div class="row my-5">
    <div class="col">
        <h2 class="d-inline-block">Profiles</h2>
        <a href="#" class="btn btn-ergatas-primary float-right mb-4" 
                data-bind="visible: canEdit, click: $root.navigateFn('/profile/new')">New Profile</a>
        <table class="table table-striped">
            <tbody data-bind="foreach: managedProfiles ">
                <tr>
                    <td data-bind="text: organization_display_name"></td>
                    <td data-bind="text: missionary_name"></td>
                    <td data-bind="text: state"></td>
                    <td>
                        <span data-bind="visible: published">Published</span>
                    </td>
                    <td>
                        <a href="#" data-bind="click: $root.navigateFn('/profile/preview/'+missionary_profile_key)"><i title="View" class="mx-2 fa fa-eye fa-2x"></i></a>
                        <a href="#" data-bind="visible: $component.canEdit,click: $root.navigateFn('/profile/edit/'+missionary_profile_key)"><i title="Edit" class="mx-2 fa fa-edit fa-2x"></i></a>
                        <a href="#" data-bind="click: $component.resendInvite"><i title="Invite" class="mx-2 fa fa-user-friends fa-2x"></i></a>
                        <a href="#" data-bind="click: $component.deleteProfile"><i title="Delete" class="mx-2 fa fa-trash-alt fa-2x"></i></a>
                    </td>
                </tr>
                
            </tbody>
        </table>


    </div>
    
</div>
<div class="row my-5" data-bind="visible: $root.hasRole('organization_review')" >
    <div class="col">
        <h2>Admin</h2>
        <button class="btn btn-secondary" 
            data-bind="click: $root.navigateFn('organization-review')">Pending Organizations</button>
        <button class="btn btn-secondary" 
            data-bind="click: $root.navigateFn('reports')">Reports</button>
        <button class="btn btn-secondary" 
            data-bind="click: $root.navigateFn('message-moderation')">Message Moderation</button>
    </div>
    <div class="col" data-bind="with: permissionForm">
        <h2>Permissions</h2>
        <div class="form-group">
            <label for="user_key">user_key</label>
            <input class="form-control" id="user_key" data-bind="value: userKey"/>
        </div>
        <div class="form-group">
            <label for="org_key">organization_key</label>
            <input class="form-control" id="org_key" data-bind="value: orgKey"/>
        </div>
        <div class="form-check " >
            <label for="read_only" class="form-check-label">
                <input type="checkbox" id="read_only" required class="form-check-input mb-2" data-bind="checked: readOnly">
                Read Only (cannot create/edit profiles).
            </label>
        </div>


        <button class="btn btn-secondary" data-bind="click: $component.addUserOrg">Add</button>
    </div>
</div>
<div class="row my-5 pb-4">
    <div class="col">

        <button class="btn btn-ergatas-secondary-border" data-bind="click: $root.navigateFn('claim-org') ">Claim Organization</button>
        <button class="btn btn-outline-danger" data-bind="click: $root.deleteAccount">Delete Account</button>
    </div>
</div>
