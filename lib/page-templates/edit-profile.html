<div class="container">
    <div class="row">
    <div class="col-lg-12">
        <h3>Missionary Profile</h3>
    </div>
    </div>
    <div class="row">
        <div class="col-lg-12">
            <a data-toggle="collapse" class="my-3" href="#warning-message" >Serving in a sensative location?</a>
            <div class="collapse" id="warning-message">
                <p class="alert alert-danger">
                    If you are a missionary serving in a sensative country, please consider
                    very carefully what information you fill in here. All of this information will be publically
                    visible. You may want to leave out some details, such as your location, or it may
                    be better to not create a profile at all. 
                </p>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-6">
            <div data-bind="template:{data: $root.userProfile().data,
                name:'profile-form-template'}"></div>
        </div>
    </div>
</div>
<script type="text/html" id="profile-form-template">
    <style>
        .profile .filepond--root {
            width:170px;
            margin: 0 auto;
        }
    </style>
    <form data-bind="submit:$root.saveProfile">
      <div class='form-group'>
        <label for="organization">Organization</label>
        <select  placeholder="Non-profits"  data-bind="selectize:organization_key, selectizeOptions: $root.orgSelectizeOptions"> </select> 
        <a href="#" data-bind="click: $root.navigateFn('org-application')" style="font-size:0.7em;">Don't see your organization?</a>
      </div>

      <div class='form-group profile' >
        <label for="profile-picture">Profile Picture</label><br>
        <div data-bind="visible: picture_url() != null && picture_url() != '' ">
            <img width="200" data-bind="attr:{src: $root.profilePictureUrl()}"/>
            <br>
            <button class="btn btn-info" data-bind="click: $root.replaceProfilePicture" >Upload New Image</button>
        </div>
        <div data-bind="visible: picture_url() == null || picture_url() === '' " class="profile">
            <input type="file"  data-bind="filepond: $root.profilePicturePondOptions " accept="image/png, image/jpeg, image/gif"/>
        </div>
      </div>



      <div class='form-group'>
        <label for="first_name">First Name</label>
        <input class='form-control' required id="first_name" name="first_name" data-bind="value:  first_name"/>
      </div>
      <div class='form-group'>
        <label for="last_name">Last Name</label>
        <input class='form-control' required id="last_name" name="last_name" data-bind="value:  last_name"/>
      </div>

      <div>
        <label for="jobs">Jobs</label>
        <select id="jobs" placeholder="Jobs" name="profile_jobs_view" data-bind="selectize:job_catagory_keys,
            selectizeOptions: $root.jobSelectizeOptions,selectizeMode: 'fixedOptions'">
           </select> <br>
      </div>


      <location-input params="mapPlatform: $root.mapPlatform,lat: location_lat, lng: location_long, location: location, country: country"></location-input>

      <div class='form-group'>
        <label for="donation_url">Donation URL</label>
        <input class="form-control" type="url" required id="donation_url" placeholder="URL" name="donation_url" data-bind="value: donation_url" /> <br>
      </div>
      <div class='form-group'>
        <label for="support">Current Support Percentage: <span data-bind="text:current_support_percentage"></span>%</label>
        <input class="form-control" type="range" min="0" max="100" required placeholder="Support Percentage" id="support" 
          name="current_support_percentage" data-bind="value: current_support_percentage" /> <br>
      </div>
      <div class='form-group'>
        <label for="description">Description</label>
        <textarea class="form-control" placeholder="Description" id="description" name="description" data-bind="value: description"></textarea><br>
      </div>

<!-- 
      -->
        <div class='form-group'>
        <label for="description">Additional Files</label><br>

        <file-collection params="filenameFilter: [$root.userProfile().data.picture_url()],
                token: $root.token(),
                bucketPrefix: $root.loggedInUser().external_user_id(),
                uploadAllFn: $root.uploadAdditionalFilesFn "></file-collection>
      </div>

      <button class="btn btn-primary">Save</button>
    </form>
</script>

